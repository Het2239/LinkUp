<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Companion</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Poppins', sans-serif;
        }
        .auth-container {
            background: linear-gradient(135deg, #6366f1 0%, #3b82f6 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        :root {
            color-scheme: light dark;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        #homepage {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900">
    <!-- Auth Container -->
    <div id="authPage" class="auth-container min-h-screen flex items-center justify-center p-4">
        <div class="glass-effect w-full max-w-md p-8 rounded-2xl shadow-xl">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-white mb-2">Student Companion</h1>
                <p class="text-gray-200">Your college life, simplified.</p>
            </div>

            <!-- Auth Tabs -->
            <div class="mb-6">
                <div class="flex space-x-2 mb-6">
                    <button onclick="switchTab('login')" class="flex-1 py-2 px-4 rounded-lg bg-white bg-opacity-20 text-white hover:bg-opacity-30 transition" id="loginTab">Student Login</button>
                    <button onclick="switchTab('admin')" class="flex-1 py-2 px-4 rounded-lg bg-white bg-opacity-20 text-white hover:bg-opacity-30 transition" id="adminTab">Admin Login</button>
                    <button onclick="switchTab('register')" class="flex-1 py-2 px-4 rounded-lg bg-white bg-opacity-20 text-white hover:bg-opacity-30 transition" id="registerTab">Register</button>
                </div>

                <!-- Login Form -->
                <form id="loginForm" class="space-y-4" onsubmit="handleLogin(event)">
                    <div>
                        <input type="email" id="loginEmail" placeholder="Email" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <div>
                        <input type="password" id="loginPassword" placeholder="Password" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <button type="submit" class="w-full py-3 rounded-lg bg-white text-indigo-600 font-semibold hover:bg-opacity-90 transition">Login</button>
                </form>

                <!-- Admin Form -->
                <form id="adminForm" class="space-y-4 hidden" onsubmit="handleAdminLogin(event)">
                    <div>
                        <input type="password" id="adminPassword" placeholder="Admin Password" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <button type="submit" class="w-full py-3 rounded-lg bg-white text-indigo-600 font-semibold hover:bg-opacity-90 transition">Admin Login</button>
                </form>

                <!-- Register Form -->
                <form id="registerForm" class="space-y-4 hidden" onsubmit="handleRegister(event)">
                    <div>
                        <input type="text" id="registerName" placeholder="Full Name" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <div>
                        <input type="email" id="registerEmail" placeholder="College Email" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <div>
                        <input type="password" id="registerPassword" placeholder="Create Password" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <div>
                        <input type="password" id="confirmPassword" placeholder="Confirm Password" class="w-full p-3 rounded-lg bg-white bg-opacity-20 text-white placeholder-gray-300 outline-none" required>
                    </div>
                    <button type="submit" class="w-full py-3 rounded-lg bg-white text-indigo-600 font-semibold hover:bg-opacity-90 transition">Register</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Homepage with Navbar -->
    <div id="homepage" class="min-h-screen bg-gray-50 dark:bg-gray-900">
        <!-- Navbar -->
        <nav class="bg-indigo-600 text-white shadow-lg">
            <div class="container mx-auto px-4">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center space-x-4">
                        <h1 class="text-2xl font-bold">Student Companion</h1>
                        <span id="welcomeMessage" class="hidden md:inline text-sm">Welcome, <span id="userName">User</span>!</span>
                    </div>
                    
                    <div class="flex items-center">
                        <button id="logoutBtn" class="py-1 px-2 md:py-2 md:px-4 text-xs md:text-base rounded-lg bg-white bg-opacity-20 hover:bg-opacity-30 transition" onclick="logout()">Logout</button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden bg-indigo-700 text-white">
            <div class="container mx-auto px-4 py-2">
                <button class="w-full text-left py-2 px-4 hover:bg-indigo-600 rounded-lg" onclick="logout()">Logout</button>
            </div>
        </div>

        <!-- Sidebar Navigation -->
        <div class="flex flex-col md:flex-row">
            <!-- Sidebar -->
            <div id="sidebar" class="fixed md:relative w-64 bg-indigo-800 text-white h-screen z-40 transform -translate-x-full md:translate-x-0 transition-transform duration-300">
                <div class="p-4">
                    <h2 class="text-xl font-semibold mb-4">Features</h2>
                    <ul class="space-y-2">
                        <li><a href="#" class="block py-2 px-4 rounded-lg nav-link" onclick="loadContent('notice')">Notice Board</a></li>
                        <li><a href="taxi-search.html" class="block py-2 px-4 rounded-lg nav-link">Taxi Search</a></li>
                        <li><a href="#" class="block py-2 px-4 rounded-lg nav-link" onclick="loadContent('study')">Study Materials</a></li>
                        <li><a href="#" class="block py-2 px-4 rounded-lg nav-link" onclick="loadContent('mail')">Mail Formats</a></li>
                        <li><a href="kyp.html" class="block py-2 px-4 rounded-lg nav-link" >Know Your People</a></li>
                        <li><a href="outings.html" class="block py-2 px-4 rounded-lg nav-link" >Outings & Trips</a></li>
                        <li><a href="messmenu.html" class="block py-2 px-4 rounded-lg nav-link" >Mess & Canteen</a></li>
                    </ul>
                </div>
            </div>

            <div class="fixed bottom-4 left-4 z-40 md:hidden">
                <button onclick="toggleSidebar()" class="bg-indigo-600 text-white p-3 rounded-full shadow-lg">
                    <i class="bi bi-list text-xl"></i>
                </button>
            </div>

            <!-- Main Content -->
            <div class="flex-1 p-8">
                <div id="contentArea" class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                    <!-- Default content (Notice Board) -->
                    <div id="notice" class="content-section">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Notice Board</h2>
                        <p class="text-gray-600 dark:text-gray-300">Welcome to the Student Companion Notice Board! Important announcements and updates will appear here.</p>
                        <div class="mt-6 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg">
                            <h3 class="font-semibold text-gray-800 dark:text-white">No new announcements</h3>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Check back later for updates</p>
                        </div>
                    </div>

                    <!-- Other content sections (hidden by default) -->
                    <div id="taxi" class="content-section hidden">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Taxi Search</h2>
                        <p class="text-gray-600 dark:text-gray-300">Find and join taxi groups for shared rides.</p>
                    </div>

                    <div id="study" class="content-section hidden">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Study Materials</h2>
                        <p class="text-gray-600 dark:text-gray-300">Access and share study materials and resources.</p>
                    </div>

                    <div id="mail" class="content-section hidden">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Mail Formats</h2>
                        <p class="text-gray-600 dark:text-gray-300">Templates for common emails and important contacts.</p>
                    </div>

                    <div id="people" class="content-section hidden">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Know Your People</h2>
                        <p class="text-gray-600 dark:text-gray-300">Directory of important contacts and representatives.</p>
                    </div>

                    <div id="trips" class="content-section hidden">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Outings & Trips</h2>
                        <p class="text-gray-600 dark:text-gray-300">Plan and join trips and outings with fellow students.</p>
                    </div>

                    <div id="mess" class="content-section hidden">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800 dark:text-white">Mess & Canteen</h2>
                        <p class="text-gray-600 dark:text-gray-300">View mess schedules and canteen menus.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize local storage database if it doesn't exist
        if (!localStorage.getItem('userDatabase')) {
            localStorage.setItem('userDatabase', JSON.stringify([]));
        }

        function switchTab(tab) {
            const forms = {
                login: document.getElementById('loginForm'),
                admin: document.getElementById('adminForm'),
                register: document.getElementById('registerForm')
            };
            
            // Hide all forms
            Object.values(forms).forEach(form => form.classList.add('hidden'));
            
            // Show selected form
            forms[tab].classList.remove('hidden');
            
            // Update active tab styling
            document.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('bg-opacity-30');
            });
            document.getElementById(`${tab}Tab`).classList.add('bg-opacity-30');
        }
        function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('-translate-x-full');
    
    // Icon changing code has been removed
}

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Retrieve user database
            const userDatabase = JSON.parse(localStorage.getItem('userDatabase'));
            
            // Find user
            const user = userDatabase.find(user => user.email === email && user.password === password);
            
            if (user) {
                // Login successful
                showHomepage(user.name);
            } else {
                alert('Invalid email or password');
            }
        }

        function handleAdminLogin(e) {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            
            // Check admin password
            if (password === 'admin123') {
                // Admin login successful
                showHomepage('Admin');
            } else {
                alert('Invalid admin password');
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Check if passwords match
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
            
            // Retrieve user database
            const userDatabase = JSON.parse(localStorage.getItem('userDatabase'));
            
            // Check if email already exists
            if(name==="admin" || name==="Admin"){
                alert('Username cannot be "admin" or "Admin"');
                
                return;
            }
            if (userDatabase.some(user => user.email === email)) {
                alert('Email already registered');
                return;
            }
            
            // Add new user
            userDatabase.push({
                name,
                email,
                password
            });
            
            // Save updated database
            localStorage.setItem('userDatabase', JSON.stringify(userDatabase));
            
            // Registration successful
            alert('Registration successful! You can now log in.');
            
            // Redirect to login
            switchTab('login');
        }

        function showHomepage(userName) {
    // Hide auth page
    document.getElementById('authPage').style.display = 'none';
    
    // Show homepage
    document.getElementById('homepage').style.display = 'block';
    
    // Set welcome message
    document.getElementById('userName').textContent = userName;
    document.getElementById('welcomeMessage').classList.remove('hidden');
    
    // Store user info in sessionStorage instead of localStorage
    sessionStorage.setItem('currentUserData', JSON.stringify({
        name: userName,
        email: document.getElementById('loginEmail').value || 'admin@example.com'
    }));
}

function logout() {
    // Hide homepage
    document.getElementById('homepage').style.display = 'none';
    
    // Show auth page
    document.getElementById('authPage').style.display = 'flex';
    
    // Reset forms
    document.getElementById('loginForm').reset();
    document.getElementById('adminForm').reset();
    document.getElementById('registerForm').reset();
    
    // Switch to login tab
    switchTab('login');
    
    // Clear session storage
    sessionStorage.removeItem('currentUserData');
}

        function loadContent(section) {
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(section).classList.remove('hidden');
        }

        // Mobile menu toggle
        // document.getElementById('mobileMenuBtn').addEventListener('click', () => {
        //     const mobileMenu = document.getElementById('mobileMenu');
        //     mobileMenu.classList.toggle('hidden');
        // });

        // Check for system dark mode preference
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        // Handle page parameters (for navigation from other pages)
        document.addEventListener('DOMContentLoaded', function() {
    // Check if user is logged in
    const userData = sessionStorage.getItem('currentUserData');
    if (userData) {
        const user = JSON.parse(userData);
        showHomepage(user.name);
        
        // Check for page parameter in URL
        const urlParams = new URLSearchParams(window.location.search);
        const page = urlParams.get('page');
        if (page) {
            loadContent(page);
        }
    }
});
    </script>
</body>
</html>